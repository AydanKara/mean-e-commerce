import{c as k,f as F,g as q,h as L,i as U,j as O,s as R,t as P,u as D,v as A,x as W}from"./chunk-SMQGBKL2.js";import{s as V}from"./chunk-7CMIEGEP.js";import{a as z}from"./chunk-K4HZE4PH.js";import"./chunk-BRGKWRVN.js";import"./chunk-T3Q3DASN.js";import"./chunk-QI2QTTT6.js";import"./chunk-MAQY66WU.js";import{m as w,n as T,q as N}from"./chunk-HXLDE4VL.js";import{Bb as g,Db as m,Nb as i,Ob as n,Pb as C,Sb as x,Xb as u,Zb as d,a as S,ab as E,db as l,ia as y,ic as _,jc as o,kc as M,mb as I,nc as v,oc as b,pc as h,ra as p,sa as f}from"./chunk-XVGCL5GT.js";function B(t,r){t&1&&(i(0,"small"),o(1,"Name is required."),n())}function Z(t,r){t&1&&(i(0,"small"),o(1," Name must be at least 2 characters long. "),n())}function G(t,r){t&1&&(i(0,"small"),o(1," Name must not exceed 50 characters. "),n())}function $(t,r){t&1&&(i(0,"small"),o(1," Name must only contain letters, numbers, and spaces. "),n())}function H(t,r){if(t&1&&(i(0,"div",18),g(1,B,2,0,"small",19)(2,Z,2,0,"small",19)(3,G,2,0,"small",19)(4,$,2,0,"small",19),n()),t&2){d();let e=_(8);l(),m("ngIf",e.errors==null?null:e.errors.required),l(),m("ngIf",e.errors==null?null:e.errors.minlength),l(),m("ngIf",e.errors==null?null:e.errors.maxlength),l(),m("ngIf",e.errors==null?null:e.errors.pattern)}}function J(t,r){t&1&&(i(0,"small"),o(1,"Image URL is required."),n())}function K(t,r){t&1&&(i(0,"small"),o(1," Image URL must be a valid URL (starting with http or https). "),n())}function Q(t,r){if(t&1&&(i(0,"div",18),g(1,J,2,0,"small",19)(2,K,2,0,"small",19),n()),t&2){d();let e=_(14);l(),m("ngIf",e.errors==null?null:e.errors.required),l(),m("ngIf",e.errors==null?null:e.errors.pattern)}}function X(t,r){if(t&1){let e=x();i(0,"form",9,0),u("ngSubmit",function(){p(e);let a=_(1),c=d();return f(c.onCreateCategory(a))}),i(2,"h2",10),o(3,"Create Category"),n(),i(4,"div",11)(5,"label",12),o(6,"Name *"),n(),C(7,"input",13,1),g(9,H,5,4,"div",14),n(),i(10,"div",11)(11,"label",15),o(12,"Image URL *"),n(),C(13,"input",16,2),g(15,Q,3,2,"div",14),n(),i(16,"button",17),o(17,"Create"),n()()}if(t&2){let e=_(8),s=_(14);l(9),m("ngIf",e.invalid&&e.touched),l(6),m("ngIf",s.invalid&&s.touched)}}function Y(t,r){t&1&&(i(0,"small"),o(1,"Name is required."),n())}function ee(t,r){t&1&&(i(0,"small"),o(1," Name must be at least 2 characters long. "),n())}function te(t,r){t&1&&(i(0,"small"),o(1," Name must not exceed 50 characters. "),n())}function ne(t,r){t&1&&(i(0,"small"),o(1," Name must only contain letters, numbers, and spaces. "),n())}function ie(t,r){if(t&1&&(i(0,"div",18),g(1,Y,2,0,"small",19)(2,ee,2,0,"small",19)(3,te,2,0,"small",19)(4,ne,2,0,"small",19),n()),t&2){d();let e=_(8);l(),m("ngIf",e.errors==null?null:e.errors.required),l(),m("ngIf",e.errors==null?null:e.errors.minlength),l(),m("ngIf",e.errors==null?null:e.errors.maxlength),l(),m("ngIf",e.errors==null?null:e.errors.pattern)}}function re(t,r){t&1&&(i(0,"small"),o(1,"Image URL is required."),n())}function oe(t,r){t&1&&(i(0,"small"),o(1," Image URL must be a valid URL (starting with http or https). "),n())}function ae(t,r){if(t&1&&(i(0,"div",18),g(1,re,2,0,"small",19)(2,oe,2,0,"small",19),n()),t&2){d();let e=_(14);l(),m("ngIf",e.errors==null?null:e.errors.required),l(),m("ngIf",e.errors==null?null:e.errors.pattern)}}function le(t,r){if(t&1){let e=x();i(0,"form",20,3),u("ngSubmit",function(){p(e);let a=d();return f(a.onUpdateCategory())}),i(2,"h2",10),o(3,"Edit Category"),n(),i(4,"div",11)(5,"label",21),o(6,"Name"),n(),i(7,"input",22,1),h("ngModelChange",function(a){p(e);let c=d();return b(c.selectedCategory.name,a)||(c.selectedCategory.name=a),f(a)}),n(),g(9,ie,5,4,"div",14),n(),i(10,"div",11)(11,"label",23),o(12,"Image URL"),n(),i(13,"input",24,2),h("ngModelChange",function(a){p(e);let c=d();return b(c.selectedCategory.image,a)||(c.selectedCategory.image=a),f(a)}),n(),g(15,ae,3,2,"div",14),n(),i(16,"button",25),o(17,"Update"),n(),i(18,"button",26),u("click",function(){p(e);let a=d();return f(a.isEditMode=!1)}),o(19," Cancel "),n()()}if(t&2){let e=_(1),s=_(8),a=_(14),c=d();l(7),v("ngModel",c.selectedCategory.name),l(2),m("ngIf",s.invalid&&s.touched),l(4),v("ngModel",c.selectedCategory.image),l(2),m("ngIf",a.invalid&&a.touched),l(),m("disabled",e.invalid)}}function me(t,r){if(t&1){let e=x();i(0,"tr")(1,"td"),o(2),n(),i(3,"td",27),C(4,"img",28),n(),i(5,"td")(6,"button",29),u("click",function(){let a=p(e).$implicit,c=d();return f(c.onEditCategory(a))}),o(7," Edit "),n(),i(8,"button",30),u("click",function(){let a=p(e).$implicit,c=d();return f(c.onDeleteCategory(a._id))}),o(9," Delete "),n()()()}if(t&2){let e=r.$implicit;l(2),M(e.name),l(2),m("src",e.image,E)}}var j=class t{categoryService=y(z);snackbar=y(V);categories=[];isEditMode=!1;selectedCategory={_id:"",name:"",image:""};ngOnInit(){this.fetchCategories()}fetchCategories(){this.categoryService.fetchAllCategories().subscribe({next:r=>{this.categories=r.categories},error:r=>{console.error("Error fetching categories:",r),this.snackbar.error(r.error.message)}})}onCreateCategory(r){let{name:e,image:s}=r.value;this.categoryService.createCategory({name:e,image:s}).subscribe({next:a=>{this.snackbar.success("Category created successfully!"),this.fetchCategories(),r.reset()},error:a=>{console.error("Error creating category:",a),this.snackbar.error(a.error.message)}})}onEditCategory(r){this.isEditMode=!0,this.selectedCategory=S({},r)}onUpdateCategory(){let{_id:r,name:e,image:s}=this.selectedCategory;this.categoryService.updateCategory(r,{name:e,image:s}).subscribe({next:a=>{this.snackbar.success("Category updated successfully!"),this.isEditMode=!1,this.fetchCategories()},error:a=>{console.error("Error updating category:",a),this.snackbar.error(a.error.message)}})}onDeleteCategory(r){confirm("Are you sure you want to delete this category?")&&this.categoryService.deleteCategory(r).subscribe({next:e=>{this.snackbar.success("Category deleted successfully!"),this.fetchCategories()},error:e=>{console.error("Error deleting category:",e),this.snackbar.error(e.error.message)}})}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=I({type:t,selectors:[["app-categories"]],decls:15,vars:3,consts:[["createCategoryForm","ngForm"],["name","ngModel"],["image","ngModel"],["editCategoryForm","ngForm"],["class","mb-4",3,"ngSubmit",4,"ngIf"],[3,"ngSubmit",4,"ngIf"],[1,"pt-4","mb-4","fs-5"],[1,"table"],[4,"ngFor","ngForOf"],[1,"mb-4",3,"ngSubmit"],[1,"mb-4","fs-5"],[1,"form-group"],["for","name",1,"form-label"],["id","name","name","name","required","","minlength","2","maxlength","50","pattern","^[a-zA-Z0-9 ]+$","ngModel","",1,"form-control"],["class","text-danger",4,"ngIf"],["for","image",1,"form-label"],["id","image","name","image","required","","pattern","https?://.+","ngModel","",1,"form-control"],["type","submit",1,"btn","btn-dark"],[1,"text-danger"],[4,"ngIf"],[3,"ngSubmit"],["for","name"],["id","name","name","name","required","","minlength","2","maxlength","50","pattern","^[a-zA-Z0-9 ]+$",1,"form-control",3,"ngModelChange","ngModel"],["for","image"],["id","image","name","image","required","","pattern","https?://.+",1,"form-control",3,"ngModelChange","ngModel"],["type","submit",1,"btn","btn-dark",3,"disabled"],["type","button",1,"btn","btn-outline-secondary","ms-2",3,"click"],[1,"td-img"],["alt","Category Image",3,"src"],[1,"btn","btn-outline-dark","me-3",3,"click"],[1,"btn","btn-danger",3,"click"]],template:function(e,s){e&1&&(g(0,X,18,2,"form",4)(1,le,20,5,"form",5),i(2,"h2",6),o(3,"Categories List"),n(),i(4,"table",7)(5,"thead")(6,"tr")(7,"th"),o(8,"Name"),n(),i(9,"th"),o(10,"Image"),n(),i(11,"th"),o(12,"Actions"),n()()(),i(13,"tbody"),g(14,me,10,2,"tr",8),n()()),e&2&&(m("ngIf",!s.isEditMode),l(),m("ngIf",s.isEditMode),l(13),m("ngForOf",s.categories))},dependencies:[N,w,T,W,O,k,F,q,R,P,D,A,U,L],styles:[".alert[_ngcontent-%COMP%]{border-radius:0}.td-img[_ngcontent-%COMP%]{width:7rem}.td-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:80px;object-fit:cover}"]})};export{j as CategoriesComponent};
