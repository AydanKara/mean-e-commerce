import{a as k}from"./chunk-X7KAA5KW.js";import"./chunk-VE74UDV5.js";import{a as q}from"./chunk-GQBWTHKC.js";import{i as T}from"./chunk-BWLJFYGV.js";import{A as U,C as R,c as N,e as p,h as V,i as z,n as G,q as D,r as L}from"./chunk-EQ3PTJBT.js";import{x as w}from"./chunk-JR3KB4OF.js";import"./chunk-VWCMHKBA.js";import"./chunk-T3Q3DASN.js";import"./chunk-T4ITIP7S.js";import"./chunk-QKMSTV2X.js";import{n as P,r as O}from"./chunk-SPT54WKC.js";import{Cb as c,Eb as a,Ob as o,Pb as n,Qb as _,Rb as y,Sb as E,Tb as h,Yb as x,_b as m,cb as s,ia as b,jc as I,kc as l,lb as S,mc as A,nc as F,ra as f,sa as g,yc as M}from"./chunk-IB35DNSN.js";function j(t,i){t&1&&(o(0,"small"),l(1,"Address is required."),n())}function $(t,i){t&1&&(o(0,"small"),l(1,"Address must be at least 10 characters."),n())}function B(t,i){if(t&1&&(o(0,"div",18),c(1,j,2,0,"small",1)(2,$,2,0,"small",1),n()),t&2){let e,r,d=m(2);s(),a("ngIf",(e=d.addressForm.get("address"))==null||e.errors==null?null:e.errors.required),s(),a("ngIf",(r=d.addressForm.get("address"))==null||r.errors==null?null:r.errors.minLength)}}function H(t,i){t&1&&(o(0,"small"),l(1,"City is required."),n())}function J(t,i){t&1&&(o(0,"small"),l(1,"City must be at least 4 characters."),n())}function K(t,i){if(t&1&&(o(0,"div",18),c(1,H,2,0,"small",1)(2,J,2,0,"small",1),n()),t&2){let e,r,d=m(2);s(),a("ngIf",(e=d.addressForm.get("city"))==null||e.errors==null?null:e.errors.required),s(),a("ngIf",(r=d.addressForm.get("city"))==null||r.errors==null?null:r.errors.minLength)}}function Q(t,i){t&1&&(o(0,"small"),l(1,"ZIP or Postcode is required."),n())}function W(t,i){t&1&&(o(0,"small"),l(1,"Please enter a valid ZIP or Postcode (5 digits)"),n())}function X(t,i){if(t&1&&(o(0,"div",18),c(1,Q,2,0,"small",1)(2,W,2,0,"small",1),n()),t&2){let e,r,d=m(2);s(),a("ngIf",(e=d.addressForm.get("zipCode"))==null||e.errors==null?null:e.errors.required),s(),a("ngIf",(r=d.addressForm.get("zipCode"))==null||r.errors==null?null:r.errors.pattern)}}function Y(t,i){t&1&&(o(0,"small"),l(1,"Please enter a valid Country."),n())}function ee(t,i){if(t&1&&(o(0,"div",18),c(1,Y,2,0,"small",1),n()),t&2){let e,r=m(2);s(),a("ngIf",(e=r.addressForm.get("country"))==null||e.errors==null?null:e.errors.required)}}function te(t,i){t&1&&(o(0,"small"),l(1,"Phone number is required."),n())}function ne(t,i){t&1&&(o(0,"small"),l(1,"Phone number must be 10-15 digits."),n())}function re(t,i){if(t&1&&(o(0,"div",18),c(1,te,2,0,"small",1)(2,ne,2,0,"small",1),n()),t&2){let e,r,d=m(2);s(),a("ngIf",(e=d.addressForm.get("phone"))==null||e.errors==null?null:e.errors.required),s(),a("ngIf",(r=d.addressForm.get("phone"))==null||r.errors==null?null:r.errors.pattern)}}function ie(t,i){if(t&1){let e=h();y(0),o(1,"h5",3),l(2,"Add Address"),n(),o(3,"form",4),x("ngSubmit",function(){f(e);let d=m();return g(d.onSubmit())}),o(4,"div",5)(5,"div",6)(6,"div",7)(7,"label",8),l(8,"Address"),n(),_(9,"input",9),c(10,B,3,2,"div",10),n()(),o(11,"div",11)(12,"div",7)(13,"label",8),l(14,"City"),n(),_(15,"input",12),c(16,K,3,2,"div",10),n()(),o(17,"div",11)(18,"div",7)(19,"label",8),l(20,"Zip Code"),n(),_(21,"input",13),c(22,X,3,2,"div",10),n()(),o(23,"div",11)(24,"div",7)(25,"label",8),l(26,"Country"),n(),_(27,"input",14),c(28,ee,2,1,"div",10),n()(),o(29,"div",11)(30,"div",7)(31,"label",8),l(32,"Phone"),n(),_(33,"input",15),c(34,re,3,2,"div",10),n()(),o(35,"div",6)(36,"button",16),l(37," Save Address "),n(),o(38,"button",17),x("click",function(){f(e);let d=m();return g(d.toggleEditMode())}),l(39," Cancel "),n()()()(),E()}if(t&2){let e,r,d,v,C,u=m();s(3),a("formGroup",u.addressForm),s(7),a("ngIf",((e=u.addressForm.get("address"))==null?null:e.invalid)&&((e=u.addressForm.get("address"))==null?null:e.touched)),s(6),a("ngIf",((r=u.addressForm.get("address"))==null?null:r.invalid)&&((r=u.addressForm.get("address"))==null?null:r.touched)),s(6),a("ngIf",((d=u.addressForm.get("zipCode"))==null?null:d.invalid)&&((d=u.addressForm.get("zipCode"))==null?null:d.touched)),s(6),a("ngIf",((v=u.addressForm.get("country"))==null?null:v.invalid)&&((v=u.addressForm.get("country"))==null?null:v.touched)),s(6),a("ngIf",((C=u.addressForm.get("phone"))==null?null:C.invalid)&&((C=u.addressForm.get("phone"))==null?null:C.touched)),s(2),a("disabled",u.addressForm.invalid)}}function oe(t,i){if(t&1){let e=h();y(0),o(1,"p",23),l(2),_(3,"br"),l(4),_(5,"br"),l(6),_(7,"br"),l(8),n(),o(9,"div",24)(10,"button",25),x("click",function(){f(e);let d=m(2);return g(d.toggleEditMode())}),o(11,"mat-icon"),l(12,"edit"),n()()(),E()}if(t&2){let e=m(2);s(2),A(" ",e.user==null||e.user.shippingInfo==null?null:e.user.shippingInfo.address," "),s(2),F(" ",e.user==null||e.user.shippingInfo==null?null:e.user.shippingInfo.zipCode," ",e.user==null||e.user.shippingInfo==null?null:e.user.shippingInfo.city," "),s(2),A(" ",e.user==null||e.user.shippingInfo==null?null:e.user.shippingInfo.country," "),s(2),A(" ",e.user==null?null:e.user.phone," ")}}function le(t,i){if(t&1){let e=h();o(0,"p",26),l(1,"No shipping address added yet."),n(),o(2,"a",27),x("click",function(){f(e);let d=m(2);return g(d.toggleEditMode())}),l(3," Add Address "),n()}}function de(t,i){if(t&1&&(o(0,"div",5)(1,"div",11)(2,"div",19)(3,"div",20)(4,"h4",21),l(5,"Shipping Address"),n(),c(6,oe,13,5,"ng-container",22)(7,le,4,0,"ng-template",null,0,M),n()()()()),t&2){let e=I(8),r=m();s(6),a("ngIf",r.user==null?null:r.user.shippingInfo)("ngIfElse",e)}}var Z=class t{userService=b(k);fb=b(U);snackbar=b(w);user=null;addressForm;isEditMode=!1;ngOnInit(){this.userService.getAuthState().subscribe(i=>{i?(this.user=i,this.initForm(i.shippingInfo)):this.initForm()})}initForm(i){this.addressForm=this.fb.group({address:[i?.address||"",[p.required,p.minLength(10)]],zipCode:[i?.zipCode||"",[p.required,p.pattern(/^\d{5}$/)]],city:[i?.city||"",[p.required,p.minLength(4)]],country:[i?.country||"",[p.required]],phone:[this.user?.phone||"",[p.required,p.pattern(/^[0-9]{10,15}$/)]]})}onSubmit(){if(this.addressForm.invalid)return;let i=this.addressForm.value;this.userService.updateProfile({shippingInfo:i,phone:this.addressForm.value.phone}).subscribe({next:e=>{this.user=e,this.isEditMode=!1,this.snackbar.success("Address updated successfully!")},error:e=>{console.error("Failed to update address",e),this.snackbar.error("Error updating address. Please try again.")}})}toggleEditMode(){this.isEditMode=!this.isEditMode}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=S({type:t,selectors:[["app-account-address"]],decls:2,vars:2,consts:[["noAddress",""],[4,"ngIf"],["class","row",4,"ngIf"],[1,"mb-4"],[3,"ngSubmit","formGroup"],[1,"row"],[1,"col-12"],[1,"form-group"],[1,"form-label"],["type","text","formControlName","address","placeholder","Enter address",1,"form-control"],["class","text-danger",4,"ngIf"],[1,"col-12","col-lg-6"],["type","text","formControlName","city","placeholder","Enter city",1,"form-control"],["type","text","formControlName","zipCode","placeholder","Enter zip code",1,"form-control"],["type","text","formControlName","country","placeholder","Enter country",1,"form-control"],["type","text","formControlName","phone","placeholder","Enter phone number",1,"form-control"],["type","submit",1,"btn","btn-dark","mt-3",3,"disabled"],["type","button",1,"btn","btn-outline-secondary","mt-3","ms-2",3,"click"],[1,"text-danger"],[1,"card","card-lg","bg-light","mb-5"],[1,"card-body"],[1,"mb-3"],[4,"ngIf","ngIfElse"],[1,"text-muted","mb-0"],[1,"card-action","card-action-end"],[1,"btn","btn-xs","btn-circle","btn-white-primary",3,"click"],[1,"text-muted"],[1,"btn","w-100","btn-lg","btn-outline-border","docs-creator",3,"click"]],template:function(e,r){e&1&&c(0,ie,40,7,"ng-container",1)(1,de,9,2,"div",2),e&2&&(a("ngIf",r.isEditMode),s(),a("ngIf",!r.isEditMode))},dependencies:[O,P,T,q,R,G,N,V,z,D,L],styles:[".card-lg[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%], .card-lg[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]{padding:2rem}.card-action[_ngcontent-%COMP%]{position:absolute;top:1.25rem;z-index:1}.card-action[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin-right:.5rem}.card-action-end[_ngcontent-%COMP%]{right:1.25rem}.btn-white-primary[_ngcontent-%COMP%]{background-color:#fff;color:#1f1f1f}.btn-white-primary[_ngcontent-%COMP%]:focus, .btn-white-primary[_ngcontent-%COMP%]:hover{background-color:#ff6f61;border-color:#ff6f61;color:#fff}.btn-circle[_ngcontent-%COMP%]{align-items:center;border-radius:50%!important;display:inline-flex;justify-content:center;padding:0;width:calc(3.25rem + 2px)}.btn-circle.btn-xs[_ngcontent-%COMP%]{width:calc(2.40625rem + 10px)}.btn-xs[_ngcontent-%COMP%]{height:calc(2.40625rem + 10px)!important;padding:.5rem .75rem}.btn-xs[_ngcontent-%COMP%], .btn-xxs[_ngcontent-%COMP%]{font-size:.9375rem;line-height:1.40625rem}span[_ngcontent-%COMP%]{display:flex}.btn-outline-border[_ngcontent-%COMP%]{background-color:#fff;border-color:#e5e5e5;color:#1f1f1f}.btn-outline-border[_ngcontent-%COMP%]:focus, .btn-outline-border[_ngcontent-%COMP%]:hover{background-color:#fff;border-color:#1f1f1f;color:#1f1f1f}.form-label[_ngcontent-%COMP%]{margin-bottom:.5rem!important}"]})};export{Z as AccountAddressComponent};
