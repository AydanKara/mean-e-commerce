import{a as pe}from"./chunk-DRAQ66MK.js";import{a as J}from"./chunk-ING2NEL2.js";import{a as H}from"./chunk-2EXTEYWK.js";import{f as Z,g as U,i as Y}from"./chunk-WXBTXMVX.js";import{A as ae,B as me,C as de,c as K,e as p,h as X,i as ee,m as te,n as ie,p as re,q as ne,r as oe,w as le}from"./chunk-TUIRNRYG.js";import{x as $}from"./chunk-BZ3RNFHT.js";import"./chunk-IWZCDIWM.js";import"./chunk-T3Q3DASN.js";import"./chunk-T4ITIP7S.js";import"./chunk-KMCRH5WO.js";import{m as G,n as W,q as Q,r as j}from"./chunk-ALPSVARF.js";import{$a as q,Cb as f,Eb as s,Ob as t,Pb as e,Qb as c,Tb as z,Yb as x,bc as M,cb as o,cc as I,db as T,ec as B,fc as L,gc as D,ia as v,jc as A,kc as i,lb as V,lc as b,mc as R,oc as E,pc as w,qc as O,ra as _,sa as S,sc as N,vc as k,wc as P}from"./chunk-ODWXDWB7.js";var ue=["checkoutForm"],se=()=>({standalone:!0});function fe(l,a){l&1&&(t(0,"p",52),i(1," Full Name must be at least 8 characters. "),e())}function ge(l,a){l&1&&(t(0,"p",52),i(1," Please enter a valid email. "),e())}function he(l,a){l&1&&(t(0,"p",52),i(1," Please enter a valid Country. "),e())}function ye(l,a){l&1&&(t(0,"p",52),i(1," Address must be at least 10 characters. "),e())}function Ce(l,a){l&1&&(t(0,"p",52),i(1," City must be at least 4 characters. "),e())}function ve(l,a){l&1&&(t(0,"p",52),i(1," Please enter a valid ZIP or Postcode. "),e())}function be(l,a){l&1&&(t(0,"p",52),i(1," Phone number must be 10-15 digits. "),e())}function _e(l,a){if(l&1&&(t(0,"li",30)(1,"div",53)(2,"div",54)(3,"a",55),c(4,"img",56),e()(),t(5,"div",57)(6,"p",58)(7,"a",59),i(8),e(),c(9,"br"),t(10,"span",60),i(11),k(12,"currency"),e(),t(13,"span",61),i(14," x "),e(),t(15,"span",62),i(16),e()()()()()),l&2){let r=a.$implicit;o(3),I("routerLink","/product/",r._id,""),o(),M("src",r.images,q),M("alt",r.name),o(3),I("routerLink","/product/",r._id,""),o(),b(r.name),o(3),b(P(12,9,r.price)),o(5),b(r.quantity)}}var ce=class l{constructor(a){this.fb=a;this.form=this.fb.group({fullName:["",[p.required,p.minLength(8)]],email:["",[p.required,p.email]],country:["",[p.required,p.minLength(4)]],address:["",[p.required,p.minLength(10)]],city:["",[p.required,p.minLength(4)]],zipCode:["",[p.required,p.pattern(/^\d{5}$/)]],phone:["",[p.required,p.pattern(/^[0-9]{10,15}$/)]]})}checkoutForm;cartItems=[];orderItems=[];shippingInfo={address:"",city:"",zipCode:"",country:""};user={_id:"",email:"",fullName:"",phone:""};totalPrice=0;paymentMethod="Credit Card";cartService=v(J);orderService=v(pe);userService=v(H);snackBar=v($);router=v(Z);form;errorMessage="";ngOnInit(){let a=this.cartService.getCart();this.cartItems=a.items,this.orderItems=a.items.map(r=>({product:r,quantity:r.quantity,price:r.price})),this.totalPrice=a.totalPrice,this.userService.getAuthState().subscribe(r=>{if(r){let{_id:n,fullName:d,email:u,shippingInfo:m,phone:g}=r,{address:h,city:y,zipCode:C,country:F}=m||{};this.form.patchValue({fullName:d||"",email:u||"",address:h||"",city:y||"",zipCode:C||"",country:F||"",phone:g||""}),this.shippingInfo={address:h||"",city:y||"",zipCode:C||"",country:F||""},this.user={_id:n,fullName:d||"",email:u,phone:g||""}}}),this.form.patchValue(this.shippingInfo),this.form.valueChanges.subscribe(r=>{this.shippingInfo={address:r.address,city:r.city,zipCode:r.zipCode,country:r.country}})}onSubmit(){if(this.checkoutForm?.valid){let a={_id:"",user:this.user,orderItems:this.orderItems,shippingInfo:this.shippingInfo,paymentMethod:this.paymentMethod,totalPrice:this.totalPrice,paymentStatus:"Pending",orderStatus:"Processing",isDelivered:!1,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};this.orderService.createOrder(a).subscribe({next:r=>{this.snackBar.success(r.message),this.cartService.clearCart(),this.orderService.setOrderPlaced(!0),this.router.navigate(["/order-confirmation",r.order._id])},error:r=>{this.snackBar.error(r.error.message),this.errorMessage=r.error.message}})}}static \u0275fac=function(r){return new(r||l)(T(ae))};static \u0275cmp=V({type:l,selectors:[["app-checkout"]],viewQuery:function(r,n){if(r&1&&B(ue,5),r&2){let d;L(d=D())&&(n.checkoutForm=d.first)}},decls:104,vars:25,consts:[["checkoutForm","ngForm"],[1,"pt-4","pb-5","my-6"],[1,"container"],[1,"row"],[1,"col-12","text-center"],[1,"mb-5"],[1,"col-12","col-md-7"],[3,"ngSubmit","formGroup"],[1,"mb-4","fs-5"],[1,"row","mb-5"],[1,"col-12"],[1,"form-group"],["for","fullName",1,"form-label"],["id","fullName","formControlName","fullName","type","text","placeholder","Full Name","required","",1,"form-control","form-control-sm"],["class","text-danger",4,"ngIf"],["for","email",1,"form-label"],["id","email","formControlName","email","type","email","placeholder","Email","required","",1,"form-control","form-control-sm"],["for","country",1,"form-label"],["id","country","formControlName","country","type","text","placeholder","Country","required","",1,"form-control","form-control-sm"],["for","address",1,"form-label"],["id","address","formControlName","address","type","text","placeholder","Address","required","",1,"form-control","form-control-sm"],[1,"col-12","col-md-6"],["for","city",1,"form-label"],["id","city","formControlName","city","type","text","placeholder","Town / City","required","",1,"form-control","form-control-sm"],["for","zipCode",1,"form-label"],["id","zipCode","formControlName","zipCode","type","text","placeholder","ZIP / Postcode","required","",1,"form-control","form-control-sm"],[1,"form-group","mb-0"],["for","phone",1,"form-label"],["id","phone","formControlName","phone","type","tel","placeholder","Mobile Phone","required","",1,"form-control","form-control-sm"],[1,"list-group","list-group-sm","mb-7"],[1,"list-group-item"],[1,"form-check","custom-radio"],["id","checkoutPaymentCard","name","payment","type","radio",1,"form-check-input",3,"ngModelChange","ngModel","ngModelOptions","value"],["for","checkoutPaymentCard",1,"form-check-label","fs-sm","text-body","text-nowrap"],["src","https://yevgenysim-turkey.github.io/shopper/assets/img/brands/color/cards.svg","alt","...",1,"ms-2"],["id","checkoutPaymentPaypal","name","payment","type","radio",1,"form-check-input",3,"ngModelChange","ngModel","ngModelOptions","value"],["for","checkoutPaymentPaypal",1,"form-check-label","fs-sm","text-body","text-nowrap"],["src","https://yevgenysim-turkey.github.io/shopper/assets/img/brands/color/paypal.svg","alt","..."],[1,"col-12","col-md-5","col-lg-4","offset-lg-1"],[1,"mb-4"],[1,"my-4"],[1,"list-group","list-group-lg","list-group-flush-y","list-group-flush-x","mb-3"],["class","list-group-item",4,"ngFor","ngForOf"],[1,"card","mb-4","bg-light"],[1,"card-body"],[1,"list-group","list-group-sm","list-group-flush-y","list-group-flush-x"],[1,"list-group-item","d-flex"],[1,"ms-auto","fs-sm"],[1,"list-group-item","d-flex","fs-lg","fw-bold"],[1,"ms-auto"],[1,"mb-3","fs-xs","text-gray-500"],["type","button",1,"btn","w-100","btn-dark",3,"click","disabled"],[1,"text-danger"],[1,"row","align-items-center"],[1,"col-4",2,"height","6rem"],[3,"routerLink"],[1,"img-fluid","w-100","h-100","object-fit-cover",3,"src","alt"],[1,"col"],[1,"mb-4","fs-sm","fw-bold"],[1,"text-body",3,"routerLink"],[1,"text-muted"],[1,"fw-bold"],[1,"fw-bolder"]],template:function(r,n){if(r&1){let d=z();t(0,"section",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"h1",5),i(5,"Checkout"),e()()(),t(6,"div",3)(7,"div",6)(8,"form",7,0),x("ngSubmit",function(){return _(d),S(n.onSubmit())}),t(10,"h2",8),i(11,"Billing Details"),e(),t(12,"div",9)(13,"div",10)(14,"div",11)(15,"label",12),i(16,"Full Name *"),e(),c(17,"input",13),f(18,fe,2,0,"p",14),e()(),t(19,"div",10)(20,"div",11)(21,"label",15),i(22,"Email *"),e(),c(23,"input",16),f(24,ge,2,0,"p",14),e()(),t(25,"div",10)(26,"div",11)(27,"label",17),i(28,"Country *"),e(),c(29,"input",18),f(30,he,2,0,"p",14),e()(),t(31,"div",10)(32,"div",11)(33,"label",19),i(34,"Address *"),e(),c(35,"input",20),f(36,ye,2,0,"p",14),e()(),t(37,"div",21)(38,"div",11)(39,"label",22),i(40,"Town / City *"),e(),c(41,"input",23),f(42,Ce,2,0,"p",14),e()(),t(43,"div",21)(44,"div",11)(45,"label",24),i(46,"ZIP / Postcode *"),e(),c(47,"input",25),f(48,ve,2,0,"p",14),e()(),t(49,"div",10)(50,"div",26)(51,"label",27),i(52,"Mobile Phone *"),e(),c(53,"input",28),f(54,be,2,0,"p",14),e()()(),t(55,"h2",8),i(56,"Payment"),e(),t(57,"div",29)(58,"div",30)(59,"div",31)(60,"input",32),O("ngModelChange",function(m){return _(d),w(n.paymentMethod,m)||(n.paymentMethod=m),S(m)}),e(),t(61,"label",33),i(62," Credit Card "),c(63,"img",34),e()()(),t(64,"div",30)(65,"div",31)(66,"input",35),O("ngModelChange",function(m){return _(d),w(n.paymentMethod,m)||(n.paymentMethod=m),S(m)}),e(),t(67,"label",36),c(68,"img",37),e()()()()()(),t(69,"div",38)(70,"h6",39),i(71),e(),c(72,"hr",40),t(73,"ul",41),f(74,_e,17,11,"li",42),e(),t(75,"div",43)(76,"div",44)(77,"ul",45)(78,"li",46)(79,"span"),i(80,"Subtotal"),e(),t(81,"span",47),i(82),k(83,"currency"),e()(),t(84,"li",46)(85,"span"),i(86,"Tax"),e(),t(87,"span",47),i(88,"$00.00"),e()(),t(89,"li",46)(90,"span"),i(91,"Shipping"),e(),t(92,"span",47),i(93,"$8.00"),e()(),t(94,"li",48)(95,"span"),i(96,"Total"),e(),t(97,"span",49),i(98),k(99,"currency"),e()()()()(),t(100,"p",50),i(101," Your personal data will be used to process your order, support your experience throughout this website, and for other purposes described in our privacy policy. "),e(),t(102,"button",51),x("click",function(){_(d);let m=A(9);return S(m.ngSubmit.emit())}),i(103," Place Order "),e()()()()()}if(r&2){let d,u,m,g,h,y,C;o(8),s("formGroup",n.form),o(10),s("ngIf",((d=n.form.get("fullName"))==null?null:d.touched)&&((d=n.form.get("fullName"))==null?null:d.invalid)),o(6),s("ngIf",((u=n.form.get("email"))==null?null:u.touched)&&((u=n.form.get("email"))==null?null:u.invalid)),o(6),s("ngIf",((m=n.form.get("country"))==null?null:m.touched)&&((m=n.form.get("country"))==null?null:m.invalid)),o(6),s("ngIf",((g=n.form.get("address"))==null?null:g.touched)&&((g=n.form.get("address"))==null?null:g.invalid)),o(6),s("ngIf",((h=n.form.get("city"))==null?null:h.touched)&&((h=n.form.get("city"))==null?null:h.invalid)),o(6),s("ngIf",((y=n.form.get("zipCode"))==null?null:y.touched)&&((y=n.form.get("zipCode"))==null?null:y.invalid)),o(6),s("ngIf",((C=n.form.get("phone"))==null?null:C.touched)&&((C=n.form.get("phone"))==null?null:C.invalid)),o(6),E("ngModel",n.paymentMethod),s("ngModelOptions",N(23,se))("value","Credit Card"),o(6),E("ngModel",n.paymentMethod),s("ngModelOptions",N(24,se))("value","PayPal"),o(5),R("Order Items (",n.orderItems.length,")"),o(3),s("ngForOf",n.cartItems),o(8),b(P(83,19,n.totalPrice)),o(16),b(P(99,21,n.totalPrice)),o(4),s("disabled",n.form.invalid)}},dependencies:[j,G,W,Q,Y,U,me,ie,K,re,X,ee,le,te,de,ne,oe],styles:[".card-body[_ngcontent-%COMP%]{flex:1 1 auto;padding:1.5rem}.cart-items[_ngcontent-%COMP%]{max-height:50rem;overflow-y:auto;overflow-x:hidden}.list-group[_ngcontent-%COMP%]{border-radius:0;max-height:25rem;overflow-y:auto;overflow-x:hidden}.list-group-item[_ngcontent-%COMP%]{border:1px solid #e5e5e5;display:block;padding:1.5rem;position:relative}.list-group-item[_ngcontent-%COMP%], .list-group-item-action[_ngcontent-%COMP%]:active{background-color:transparent;color:#1f1f1f}.list-group-item[_ngcontent-%COMP%] + .list-group-item[_ngcontent-%COMP%]{border-top-width:0}.list-group-sm[_ngcontent-%COMP%]   .list-group-item[_ngcontent-%COMP%]{padding:1.25rem}.list-group-flush-x[_ngcontent-%COMP%]   .list-group-item[_ngcontent-%COMP%]{border-left:none;border-right:none;padding-left:0;padding-right:0}.list-group-flush-y[_ngcontent-%COMP%]   .list-group-item[_ngcontent-%COMP%]:first-child{border-top:none;padding-top:0}.list-group-flush-y[_ngcontent-%COMP%]   .list-group-item[_ngcontent-%COMP%]:last-child{border-bottom:0;padding-bottom:0}.btn-link[_ngcontent-%COMP%]{color:#1f1f1f;font-weight:500}"]})};export{ce as CheckoutComponent};
