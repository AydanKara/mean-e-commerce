import{a as W}from"./chunk-23CUZQWY.js";import{f as j,g as A,h as U,i as Y,j as z,o as G,p as J,q as H,x as K}from"./chunk-SMQGBKL2.js";import{s as D}from"./chunk-7CMIEGEP.js";import{a as X}from"./chunk-SHORG633.js";import{g as R,i as $}from"./chunk-NTBE4NJ6.js";import"./chunk-BRGKWRVN.js";import"./chunk-T3Q3DASN.js";import"./chunk-T4ITIP7S.js";import"./chunk-MAQY66WU.js";import{m as V,n as L,p as B,q as Q}from"./chunk-HXLDE4VL.js";import{Bb as d,Db as s,Nb as i,Ob as n,Pb as x,Sb as M,Xb as v,Zb as m,a as y,ab as k,b as S,bc as P,db as c,ia as g,ic as E,jc as o,kc as u,lc as w,mb as O,nc as T,oc as F,pc as N,ra as f,rc as b,sa as _,uc as C,vc as h,xc as q,z as I}from"./chunk-XVGCL5GT.js";var et=()=>({standalone:!0}),it=()=>[];function nt(r,e){r&1&&(i(0,"div",29)(1,"span",30),o(2,"Loading..."),n()())}function ot(r,e){if(r&1&&(i(0,"option",47),o(1),n()),r&2){let t=e.index,l=m().$implicit;s("value",t+1)("disabled",t+1>l.stock),c(),w(" ",t+1," ")}}function rt(r,e){if(r&1){let t=M();i(0,"ul",33)(1,"li",34)(2,"div",35)(3,"div",36)(4,"a",37),x(5,"img",38),n()(),i(6,"div",13)(7,"div",39)(8,"a",40),o(9),n(),i(10,"span",41),o(11),C(12,"currency"),n()(),i(13,"p",42),o(14,"Quantity:"),n(),i(15,"div",43)(16,"select",44),N("ngModelChange",function(a){let p=f(t).$implicit;return F(p.quantity,a)||(p.quantity=a),_(a)}),v("change",function(){let a=f(t).$implicit,p=m(2);return _(p.updateCart(a))}),d(17,ot,2,3,"option",45),n(),i(18,"a",46),v("click",function(){let a=f(t).$implicit,p=m(2);return _(p.removeFromCart(a._id))}),o(19," Remove "),n()()()()()()}if(r&2){let t=e.$implicit;c(4),P("routerLink","/product/",t._id,""),c(),s("src",t.images,k)("alt",t.name),c(4),u(t.name),c(2),u(h(12,9,t.price)),c(5),T("ngModel",t.quantity),s("ngModelOptions",b(11,et)),c(),s("ngForOf",b(12,it).constructor(t.stock||0))}}function at(r,e){if(r&1&&(i(0,"div",31),d(1,rt,20,13,"ul",32),n()),r&2){let t=m();c(),s("ngForOf",t.cartItems)}}function lt(r,e){r&1&&(i(0,"h4",49),o(1," Your cart is empty. "),n())}function ct(r,e){if(r&1&&d(0,lt,2,0,"h4",48),r&2){let t=m();s("ngIf",!t.loading)}}var Z=class r{cartService=g(W);shopService=g(X);snackbar=g(D);cartItems=[];totalPrice=0;loading=!1;ngOnInit(){this.loadCartItems()}loadCartItems(){this.loading=!0;let t=this.cartService.getCart()?.items||[],l=t.map(a=>this.shopService.getProductById(a._id));I(l).subscribe({next:a=>{this.loading=!1,this.cartItems=t.map((p,tt)=>S(y({},p),{stock:a[tt]?.stock||0})),this.calculateTotalPrice()},error:a=>{this.loading=!1,console.error("Error fetching stock data:",a)}})}updateCart(e){e.quantity=Number(e.quantity),e.quantity>e.stock?(this.snackbar.error("Quantity exceeds available stock!"),e.quantity=e.stock):(this.cartService.updateQuantity(e._id,e.quantity),this.calculateTotalPrice(),this.snackbar.success(e.name+" quantity updated!"))}updateQuantity(e,t){this.cartService.updateQuantity(e,t),this.ngOnInit()}removeFromCart(e){this.cartService.removeFromCart(e),this.cartItems=this.cartItems.filter(t=>t._id!==e),this.calculateTotalPrice()}calculateTotalPrice(){this.totalPrice=this.cartItems.reduce((e,t)=>e+t.price*t.quantity,0)}clearCart(){this.cartService.clearCart(),this.ngOnInit()}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=O({type:r,selectors:[["app-shopping-cart"]],decls:53,vars:11,consts:[["emptyCart",""],[1,"py-5","my-5"],[1,"container"],[1,"row"],[1,"col-12"],[1,"mb-5","text-center"],[1,"col-12","col-md-7"],["class","spinner-border text-primary d-block mx-auto my-6","role","status",4,"ngIf"],["class","cart-items",4,"ngIf","ngIfElse"],[1,"row","align-items-end","justify-content-between","mb-5","mb-md-0"],[1,"mb-3","mb-md-0"],["for","cartCouponCode",1,"form-label","fs-sm","fw-bold"],[1,"row","row","gx-5"],[1,"col"],["id","cartCouponCode","type","text","placeholder","Enter coupon code*",1,"form-control","form-control-sm"],[1,"col-auto"],["type","submit",1,"btn","btn-sm","btn-dark"],[1,"col-12","col-md-auto"],[1,"btn","btn-sm","btn-outline-dark"],[1,"col-12","col-md-5","col-lg-4","offset-lg-1","text-center"],[1,"card","mb-3","bg-light"],[1,"card-body"],[1,"list-group","list-group-sm","list-group-flush-y","list-group-flush-x"],[1,"list-group-item","d-flex"],[1,"ms-auto","fs-sm"],[1,"list-group-item","d-flex","fs-lg","fw-bold"],[1,"list-group-item","fs-sm","text-center","text-gray-500"],["routerLink","/checkout",1,"btn","w-100","btn-dark","mb-2",3,"disabled","title"],["routerLink","/shop",1,"link-underline","my-2"],["role","status",1,"spinner-border","text-primary","d-block","mx-auto","my-6"],[1,"visually-hidden"],[1,"cart-items"],["class","list-group list-group-lg list-group-flush-x mb-3",4,"ngFor","ngForOf"],[1,"list-group","list-group-lg","list-group-flush-x","mb-3"],[1,"list-group-item"],[1,"row","align-items-center","pe-4"],[1,"col-3"],[1,"docs-creator",3,"routerLink"],[1,"img-fluid",3,"src","alt"],[1,"d-flex","mb-2","fw-bold"],[1,"text-body"],[1,"ms-auto"],[1,"mb-7","fs-sm","text-muted"],[1,"d-flex","align-items-center"],[1,"form-select","form-select-xxs","w-auto",3,"ngModelChange","change","ngModel","ngModelOptions"],[3,"value","disabled",4,"ngFor","ngForOf"],[1,"fs-xs","text-gray-400","ms-auto",3,"click"],[3,"value","disabled"],["class","text-center mx-5 my-6",4,"ngIf"],[1,"text-center","mx-5","my-6"]],template:function(t,l){if(t&1&&(i(0,"section",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"h3",5),o(5,"Shopping Cart"),n()()(),i(6,"div",3)(7,"div",6),d(8,nt,3,0,"div",7)(9,at,2,1,"div",8)(10,ct,1,1,"ng-template",null,0,q),i(12,"div",9)(13,"div",6)(14,"form",10)(15,"label",11),o(16," Coupon code: "),n(),i(17,"div",12)(18,"div",13),x(19,"input",14),n(),i(20,"div",15)(21,"button",16),o(22," Apply "),n()()()()(),i(23,"div",17)(24,"button",18),o(25,"Update Cart"),n()()()(),i(26,"div",19)(27,"div",20)(28,"div",21)(29,"ul",22)(30,"li",23)(31,"span"),o(32,"Subtotal"),n(),i(33,"span",24),o(34),C(35,"currency"),n()(),i(36,"li",23)(37,"span"),o(38,"Tax"),n(),i(39,"span",24),o(40,"$00.00"),n()(),i(41,"li",25)(42,"span"),o(43,"Total"),n(),i(44,"span",24),o(45),C(46,"currency"),n()(),i(47,"li",26),o(48," Shipping cost calculated at Checkout * "),n()()()(),i(49,"button",27),o(50," Proceed to Checkout "),n(),i(51,"a",28),o(52," Continue Shopping "),n()()()()()),t&2){let a=E(11);c(8),s("ngIf",l.loading),c(),s("ngIf",l.cartItems.length>0&&!l.loading)("ngIfElse",a),c(25),u(h(35,7,l.totalPrice)),c(11),u(h(46,9,l.totalPrice)),c(4),s("disabled",l.cartItems.length===0)("title",l.cartItems.length===0?"Your cart is empty":"")}},dependencies:[Q,V,L,B,$,R,K,z,J,H,G,j,A,Y,U],styles:[".card-body[_ngcontent-%COMP%]{flex:1 1 auto;padding:1.5rem}.cart-items[_ngcontent-%COMP%]{max-height:50rem;overflow-y:auto;overflow-x:hidden}.list-group[_ngcontent-%COMP%]{border-radius:0}.list-group-item[_ngcontent-%COMP%]{border:1px solid #e5e5e5;display:block;padding:1.5rem;position:relative}.list-group-item[_ngcontent-%COMP%], .list-group-item-action[_ngcontent-%COMP%]:active{background-color:transparent;color:#1f1f1f}.list-group-item[_ngcontent-%COMP%] + .list-group-item[_ngcontent-%COMP%]{border-top-width:0}.list-group-sm[_ngcontent-%COMP%]   .list-group-item[_ngcontent-%COMP%]{padding:1.25rem}.list-group-flush-x[_ngcontent-%COMP%]   .list-group-item[_ngcontent-%COMP%]{border-left:none;border-right:none;padding-left:0;padding-right:0}.list-group-flush-y[_ngcontent-%COMP%]   .list-group-item[_ngcontent-%COMP%]:first-child{border-top:none;padding-top:0}.list-group-flush-y[_ngcontent-%COMP%]   .list-group-item[_ngcontent-%COMP%]:last-child{border-bottom:0;padding-bottom:0}.btn-link[_ngcontent-%COMP%]{color:#1f1f1f;font-weight:500}"]})};export{Z as ShoppingCartComponent};
