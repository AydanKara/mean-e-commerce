import{a as fe}from"./chunk-72J42I7T.js";import{a as he}from"./chunk-64A2DHUC.js";import{a as ie}from"./chunk-OBKDBIFY.js";import{a as ee}from"./chunk-QSYHGDCZ.js";import{a as de}from"./chunk-E35HKNJO.js";import{a as L}from"./chunk-5PXDNUDP.js";import{a as me,b as ue,d as ge,e as B,f as W}from"./chunk-DXQDTUKX.js";import{a as se,b as le,c as ce}from"./chunk-KULQU2PB.js";import{k as pe}from"./chunk-KIDKDS4Z.js";import"./chunk-3WI6JTCC.js";import"./chunk-2CHFHUMV.js";import{a as k,b as te}from"./chunk-P4YRGY7I.js";import{g as J}from"./chunk-OM67MVYA.js";import{B as D,c as ne,h as T,i as re,k as oe,m as E,n as ae}from"./chunk-7OU7UM32.js";import{a as K,x as X}from"./chunk-WODPYKD2.js";import"./chunk-L3S3RQJU.js";import"./chunk-T3Q3DASN.js";import"./chunk-T4ITIP7S.js";import"./chunk-BLI2WIQU.js";import{n as Q,q as $,r as O}from"./chunk-RRDE5Q37.js";import{$b as f,Db as x,Fb as c,Hb as A,Kb as I,Lb as S,Nb as C,Ob as b,Pb as r,Qb as o,Rb as h,Ub as F,Zb as m,ab as z,cc as q,db as a,dc as R,ia as d,kc as H,lc as s,mb as y,mc as _,nc as j,pc as P,qc as M,ra as u,rc as w,sa as g,tc as U,uc as G,wc as Y,xc as Z}from"./chunk-A5AGJRWB.js";var _e=n=>["/product",n];function xe(n,t){if(n&1){let e=F();r(0,"div",0)(1,"div",1)(2,"a",2),h(3,"img",3),o(),r(4,"div",4)(5,"span",5)(6,"button",6)(7,"span",7)(8,"mat-icon"),s(9,"visibility"),o()()()(),r(10,"span",5)(11,"button",8),m("click",function(){u(e);let l=f();return g(l.addToCart())}),r(12,"span",9)(13,"mat-icon"),s(14,"shopping_cart"),o()()()(),r(15,"span",5)(16,"button",8),m("click",function(){u(e);let l=f();return g(l.toggleFavorite(l.product._id))}),r(17,"span",9)(18,"mat-icon"),s(19,"favorite"),o()()()()()(),r(20,"div",10)(21,"div",11)(22,"a",12),s(23),o()(),r(24,"div",13)(25,"a",14),s(26),o()(),r(27,"div",15),s(28),Y(29,"currency"),o()()()}if(n&2){let e=f();a(2),R("routerLink","/product/",e.product._id,""),a(),q("src",e.product.images[0],z),q("alt",e.product.name),a(4),c("routerLink",G(13,_e,e.product._id)),a(9),A("active",e.isFavorite(e.product._id)),a(7),_(e.product.category.name),a(2),c("routerLink",G(15,_e,e.product._id)),a(),j(" ",e.product.name," "),a(2),j(" ",Z(29,11,e.product.price)," ")}}var N=class n{userService=d(ee);cartService=d(ie);wishlistService=d(fe);snackbar=d(X);product;userId=null;wishlist=[];ngOnInit(){this.userService.getAuthState().subscribe(t=>{this.userId=t?._id??null,this.userId&&(this.wishlistService.getWishlist(this.userId).subscribe(e=>{let i=e.map(l=>l._id);this.wishlistService.setWishlist(i)}),this.wishlistService.wishlist$.subscribe(e=>{this.wishlist=e}))})}addToCart(){if(!this.product)return;let t={_id:this.product._id,name:this.product.name,price:this.product.price,quantity:1,images:this.product.images[0],stock:this.product.stock};this.cartService.addToCart(t),this.snackbar.success(this.product.name+" added to cart!")}isFavorite(t){return this.wishlist?.includes(t)}toggleFavorite(t){if(!this.userId){this.snackbar.error("Please log in to manage your wishlist.");return}this.isFavorite(t)?this.wishlistService.removeFromWishlist(this.userId,t).subscribe({next:e=>{this.wishlist=this.wishlist.filter(i=>i!==t),this.snackbar.success(`${this.product?.name} removed from favorites!`)},error:e=>{this.snackbar.error(e.message)}}):this.wishlistService.addToWishlist(this.userId,t).subscribe({next:e=>{this.wishlist.push(t),this.snackbar.success(`${this.product?.name} added to favorites!`)},error:e=>{this.snackbar.error(e.message)}})}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=y({type:n,selectors:[["app-product-item"]],inputs:{product:"product"},decls:1,vars:1,consts:[[1,"card"],[1,"card-img"],[1,"card-img-hover",3,"routerLink"],[1,"card-img-top","card-img-back",3,"src","alt"],[1,"card-actions"],[1,"card-action"],[1,"btn","btn-xs","btn-circle","btn-white-primary"],[1,"material-symbols-outlined",3,"routerLink"],[1,"btn","btn-xs","btn-circle","btn-white-primary",3,"click"],[1,"material-symbols-outlined"],[1,"card-body","p-2"],[1,"fs-xs"],["routerLink","/shop",1,"text-muted"],[1,"fw-bold"],[1,"text-body",3,"routerLink"],[1,"fw-bold","text-muted"]],template:function(e,i){e&1&&x(0,xe,30,17,"div",0),e&2&&I(i.product?0:-1)},dependencies:[O,$,J,k],styles:[".card[_ngcontent-%COMP%]{height:100%;box-shadow:#00000040 0 14px 28px,#00000038 0 10px 10px;transition:transform .2s;border-radius:0!important}.card-img[_ngcontent-%COMP%]{display:flex;height:18rem!important}.card-img[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{width:100%;height:100%}.card-img[_ngcontent-%COMP%], .card-img-top[_ngcontent-%COMP%]{border-radius:0!important}.card-img-top[_ngcontent-%COMP%]{display:flex;width:100%;height:100%;object-fit:cover}.card[_ngcontent-%COMP%]:hover{transform:scale(1.05);box-shadow:#0000001a 0 14px 28px,#0000001a 0 10px 10px}.card-img-hover[_ngcontent-%COMP%]{display:block!important}.card-actions[_ngcontent-%COMP%]{bottom:6rem;display:flex;justify-content:center;gap:.5rem;padding:1.25rem;position:absolute;width:100%;z-index:1}.card-actions[_ngcontent-%COMP%]   .card-action[_ngcontent-%COMP%]{left:0;opacity:0;position:relative;right:0;top:0;transform:translateY(.5rem);transition:all .1s ease-in-out;transition-property:transform,opacity}.card-action[_ngcontent-%COMP%]{position:absolute;top:1.25rem;z-index:100}.card-img[_ngcontent-%COMP%]:hover   .card-actions[_ngcontent-%COMP%]   .card-action[_ngcontent-%COMP%]{opacity:1;transform:translateY(0)}.btn-circle[_ngcontent-%COMP%]{align-items:center;border-radius:50%!important;display:inline-flex!important;justify-content:center;padding:0!important;width:calc(3.25rem + 2px)}.btn-circle.btn-xs[_ngcontent-%COMP%]{width:calc(2.40625rem + 2px)}.btn-xs[_ngcontent-%COMP%]{height:calc(2.40625rem + 3px)!important;padding:.5rem .75rem}.btn-xs[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:flex}.btn-white-primary[_ngcontent-%COMP%]{background-color:#fff;color:#1f1f1f}.btn-white-primary[_ngcontent-%COMP%]:hover, .btn.active[_ngcontent-%COMP%]{background-color:#ff6f61;border-color:#ff6f61;color:#fff}"]})};function Pe(n,t){if(n&1&&(r(0,"mat-list-option",6),s(1),o()),n&2){let e=t.$implicit;c("value",e.name),a(),_(e.name)}}function Me(n,t){if(n&1&&(r(0,"mat-list-option",6),s(1),o()),n&2){let e=t.$implicit;c("value",e),a(),_(e)}}function we(n,t){if(n&1&&(r(0,"mat-list-option",6),s(1),o()),n&2){let e=t.$implicit;c("value",e),a(),_(e)}}var V=class n{shopService=d(L);dialogRef=d(se);data=d(le);selectedCategories=this.data.selectedCategories;selectedBrands=this.data.selectedBrands;selectedGenders=this.data.selectedGenders;applyFilters(){this.dialogRef.close({selectedCategories:this.selectedCategories,selectedBrands:this.selectedBrands,selectedGenders:this.selectedGenders})}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=y({type:n,selectors:[["app-filter-dialog"]],decls:26,vars:6,consts:[[1,"rounded-0"],[1,"text-xl-3","text-center","pt-3","mb-3"],[1,"d-flex","gap-4","p-4"],[1,"w-1/2"],[1,"font-sebold","text-xl","text-primary"],[3,"ngModelChange","ngModel","multiple"],[3,"value"],[1,"d-flex","justify-content-end","p-4"],["mat-flat-button","",1,"button-nav",3,"click"]],template:function(e,i){e&1&&(r(0,"div",0)(1,"h3",1),s(2,"Filters"),o(),h(3,"mat-divider"),r(4,"div",2)(5,"div",3)(6,"h4",4),s(7,"Categories"),o(),r(8,"mat-selection-list",5),w("ngModelChange",function(p){return M(i.selectedCategories,p)||(i.selectedCategories=p),p}),C(9,Pe,2,2,"mat-list-option",6,S),o()(),r(11,"div",3)(12,"h4",4),s(13,"Brands"),o(),r(14,"mat-selection-list",5),w("ngModelChange",function(p){return M(i.selectedBrands,p)||(i.selectedBrands=p),p}),C(15,Me,2,2,"mat-list-option",6,S),o()(),r(17,"div",3)(18,"h4",4),s(19,"For whom"),o(),r(20,"mat-selection-list",5),w("ngModelChange",function(p){return M(i.selectedGenders,p)||(i.selectedGenders=p),p}),C(21,we,2,2,"mat-list-option",6,S),o()()(),r(23,"div",7)(24,"button",8),m("click",function(){return i.applyFilters()}),s(25,"Apply Filters"),o()()()),e&2&&(a(8),P("ngModel",i.selectedCategories),c("multiple",!0),a(),b(i.shopService.categories),a(5),P("ngModel",i.selectedBrands),c("multiple",!0),a(),b(i.shopService.brands),a(5),P("ngModel",i.selectedGenders),c("multiple",!0),a(),b(i.shopService.genders))},dependencies:[O,ge,W,B,K,D,T,E],encapsulation:2})};var Oe=(n,t)=>t._id,Ie=()=>[5,10,20,30];function Fe(n,t){n&1&&(r(0,"div",19)(1,"div",20)(2,"span",21),s(3,"Loading..."),o()()())}function ke(n,t){if(n&1&&h(0,"app-product-item",14),n&2){let e=f().$implicit;c("product",e)}}function Te(n,t){if(n&1&&x(0,ke,1,1,"app-product-item",22),n&2){let e=f();c("ngIf",!e.loading)}}function Ee(n,t){n&1&&(r(0,"div",15)(1,"div",23),h(2,"img",24),o(),r(3,"p"),s(4,"We're sorry, but there are no products to display at the moment."),o()())}function De(n,t){if(n&1&&(r(0,"mat-list-option",18),s(1),o()),n&2){let e=t.$implicit,i=f();c("value",e.value)("selected",i.queryParams.sort===e.value),a(),_(e.name)}}var be=class n{shopService=d(L);dialogService=d(ce);products=[];totalProducts=0;currentPage=1;totalPages=1;loading=!1;sortOptions=[{name:"Relevance",value:"relevance"},{name:"Name: A-Z",value:"name_asc"},{name:"Name: Z-A",value:"name_desc"},{name:"Price: Low-High",value:"price_asc"},{name:"Price: High-Low",value:"price_desc"}];queryParams=new de;ngOnInit(){this.initializeShop()}initializeShop(){this.shopService.getAllCategories(),this.shopService.getBrands(),this.shopService.getGenders(),this.getProducts()}getProducts(){this.loading=!0,this.shopService.getAllProducts(this.queryParams).subscribe({next:t=>{this.loading=!1,this.products=t.products,this.currentPage=t.currentPage,this.totalPages=t.totalPages,this.totalProducts=t.totalProducts},error:t=>{this.loading=!1,console.log(t)}})}onSearchPage(){this.getProducts()}handlePageEvent(t){this.queryParams.page=t.pageIndex+1,this.queryParams.limit=t.pageSize,this.getProducts()}onSortChange(t){let e=t.options[0];e&&(this.queryParams.sort=e.value,this.getProducts())}openFiltersDialog(){this.dialogService.open(V,{maxWidth:"100%",data:{selectedCategories:this.queryParams.categories,selectedBrands:this.queryParams.brands,selectedGenders:this.queryParams.genders}}).afterClosed().subscribe({next:e=>{e&&(this.queryParams.categories=e.selectedCategories,this.queryParams.brands=e.selectedBrands,this.queryParams.genders=e.selectedGenders,this.getProducts())}})}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=y({type:n,selectors:[["app-shop"]],decls:33,vars:11,consts:[["searchForm","ngForm"],["sortMenu","matMenu"],[1,"d-flex","flex-column","gap-3","my-5"],[1,"container","d-flex","flex-lg-row","flex-md-column-reverse","gap-md-3","justify-content-between","align-items-center"],["role","search",1,"d-flex",3,"ngSubmit"],["type","search","placeholder","Search","aria-label","Search","name","keyword",1,"form-control","me-3","rounded-0","py-3","border-black","border-2",3,"ngModelChange","ngModel"],["type","submit",1,"button-nav","border-2","gap-2"],[1,"material-symbols-outlined","d-flex"],[1,"d-flex","gap-3","filter-sort-btn"],[1,"button-nav","border-2","gap-2",3,"click"],[1,"button-nav","border-2","gap-2",3,"matMenuTriggerFor"],[1,"container","text-center"],[1,"row","row-cols-1","row-cols-md-3","row-cols-xl-4","g-4","justify-content-center"],["class","loading-container",4,"ngIf"],[3,"product"],[1,"no-products-container","text-center"],["aria-label","Select page",1,"paginator","border-2",3,"page","length","pageSize","showFirstLastButtons","pageSizeOptions","pageIndex"],[3,"selectionChange","multiple"],[3,"value","selected"],[1,"loading-container"],["role","status",1,"spinner-border","text-primary","d-block","mt-5"],[1,"visually-hidden"],[3,"product",4,"ngIf"],[1,"media"],["src","assets/no-product-found.png","alt","No Products",1,"no-products-image"]],template:function(e,i){if(e&1){let l=F();r(0,"div",2)(1,"div",3)(2,"form",4,0),m("ngSubmit",function(){return u(l),g(i.onSearchPage())}),r(4,"input",5),w("ngModelChange",function(v){return u(l),M(i.queryParams.searchTerm,v)||(i.queryParams.searchTerm=v),g(v)}),o(),r(5,"button",6)(6,"span",7)(7,"mat-icon"),s(8,"search"),o()(),s(9," Search "),o()(),r(10,"div",8)(11,"button",9),m("click",function(){return u(l),g(i.openFiltersDialog())}),r(12,"span",7)(13,"mat-icon"),s(14,"filter_list"),o()(),s(15," Filters "),o(),r(16,"button",10)(17,"mat-icon"),s(18,"swap_vert"),o(),s(19," Sort "),o()()(),r(20,"div",11)(21,"div",12),x(22,Fe,4,0,"div",13),C(23,Te,1,1,"app-product-item",14,Oe),x(25,Ee,5,0,"div",15),o(),r(26,"mat-paginator",16),m("page",function(v){return u(l),g(i.handlePageEvent(v))}),o()()(),h(27,"app-features"),r(28,"mat-menu",null,1)(30,"mat-selection-list",17),m("selectionChange",function(v){return u(l),g(i.onSortChange(v))}),C(31,De,2,3,"mat-list-option",18,S),o()()}if(e&2){let l=H(29);a(4),P("ngModel",i.queryParams.searchTerm),a(12),c("matMenuTriggerFor",l),a(6),c("ngIf",i.loading),a(),b(i.products),a(2),I(!i.products.length&&!i.loading?25:-1),a(),c("length",i.totalProducts)("pageSize",i.queryParams.limit)("showFirstLastButtons",!0)("pageSizeOptions",U(10,Ie))("pageIndex",i.currentPage-1),a(4),c("multiple",!1),a(),b(i.sortOptions)}},dependencies:[O,Q,N,he,te,k,me,W,B,ue,pe,D,ae,ne,T,re,E,oe],styles:[".loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;height:calc(100vh - 36rem)}.mdc-text-field[_ngcontent-%COMP%]{border-radius:unset!important}button[_ngcontent-%COMP%]{color:#000!important;align-items:center}.form-control[_ngcontent-%COMP%]{min-width:23rem}.filter-sort-btn[_ngcontent-%COMP%]{height:3.75rem}.mdc-button[_ngcontent-%COMP%]{border:.125rem solid!important;font-family:inherit;letter-spacing:.1rem;font-weight:700}.no-products-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;padding:20px;margin:40px auto;width:75%;background-color:#f8f9fa;border:1px solid #dee2e6;border-radius:8px;box-shadow:0 4px 8px #0000001a}.media[_ngcontent-%COMP%]{margin-bottom:15px;border-radius:8px;box-shadow:0 4px 8px #0000001a}.no-products-image[_ngcontent-%COMP%]{width:100%;opacity:.8;border-radius:8px}.no-products-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#6c757d;font-size:16px}.paginator[_ngcontent-%COMP%]{margin-top:2rem}"]})};export{be as ShopComponent};
