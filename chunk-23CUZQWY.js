import{a as h}from"./chunk-T4ITIP7S.js";import{c as m}from"./chunk-MAQY66WU.js";import{ca as o,ia as n,k as s,t as c}from"./chunk-XVGCL5GT.js";var u=class a{http=n(m);baseUrl=`${h.apiUrl}/orders`;cartKey="cart";cart={items:[],totalPrice:0};cartSubject=new s(this.cart);constructor(){this.loadCart()}loadCart(){let t=localStorage.getItem(this.cartKey);t&&(this.cart=JSON.parse(t)),this.cartSubject.next(this.cart)}getCartObservable(){return this.cartSubject.asObservable()}saveCart(){localStorage.setItem(this.cartKey,JSON.stringify(this.cart)),this.cartSubject.next(this.cart)}addToCart(t){let r=this.cart.items.find(e=>e._id===t._id);r?r.quantity+=t.quantity:this.cart.items.push(t),this.updateTotalPrice(),this.saveCart()}removeFromCart(t){this.cart.items=this.cart.items.filter(r=>r._id!==t),this.updateTotalPrice(),this.saveCart()}updateQuantity(t,r){let e=this.cart.items.find(i=>i._id===t);e&&(e.quantity=r,this.updateTotalPrice(),this.saveCart())}updateTotalPrice(){this.cart.totalPrice=this.cart.items.reduce((t,r)=>t+r.price*r.quantity,0)}getCart(){return this.cart}getTotalQuantity(){return this.cart.items.reduce((t,r)=>t+r.quantity,0)}getTotalQuantityObservable(){return this.cartSubject.asObservable().pipe(c(t=>(t?.items||[]).reduce((e,i)=>e+i.quantity,0)))}clearCart(){this.cart={items:[],totalPrice:0},this.saveCart()}checkout(t){return this.http.post(this.baseUrl,t,{withCredentials:!0})}static \u0275fac=function(r){return new(r||a)};static \u0275prov=o({token:a,factory:a.\u0275fac,providedIn:"root"})};export{u as a};
