import{a as x}from"./chunk-WTH7AYOY.js";import{a as b}from"./chunk-JQ7IIVUH.js";import{c as N,d as c,f as E,g as y,j as A,m as T,n as U,w as q,y as D}from"./chunk-SMQGBKL2.js";import{s as S}from"./chunk-7CMIEGEP.js";import"./chunk-BRGKWRVN.js";import"./chunk-T3Q3DASN.js";import"./chunk-T4ITIP7S.js";import"./chunk-MAQY66WU.js";import{n as C,q as I}from"./chunk-HXLDE4VL.js";import{Bb as u,Db as a,Nb as o,Ob as r,Pb as f,Xb as h,Zb as p,a as w,db as i,ia as g,jc as s,kc as F,mb as P}from"./chunk-XVGCL5GT.js";function V(l,n){l&1&&(o(0,"small"),s(1,"Full Name is required."),r())}function k(l,n){l&1&&(o(0,"small"),s(1,"Full Name must be at least 10 characters."),r())}function M(l,n){if(l&1&&(o(0,"div",15),u(1,V,2,0,"small",16)(2,k,2,0,"small",16),r()),l&2){let e,t,m=p();i(),a("ngIf",(e=m.userForm.get("fullName"))==null||e.errors==null?null:e.errors.required),i(),a("ngIf",(t=m.userForm.get("fullName"))==null||t.errors==null?null:t.errors.minLength)}}function L(l,n){l&1&&(o(0,"small"),s(1,"Email is required."),r())}function O(l,n){l&1&&(o(0,"small"),s(1,"Email cannot be longer than 30 characters."),r())}function j(l,n){l&1&&(o(0,"small"),s(1,"Enter a valid email."),r())}function B(l,n){if(l&1&&(o(0,"div",15),u(1,L,2,0,"small",16)(2,O,2,0,"small",16)(3,j,2,0,"small",16),r()),l&2){let e,t,m,d=p();i(),a("ngIf",(e=d.userForm.get("email"))==null||e.errors==null?null:e.errors.required),i(),a("ngIf",(t=d.userForm.get("email"))==null||t.errors==null?null:t.errors.maxlength),i(),a("ngIf",(m=d.userForm.get("email"))==null||m.errors==null?null:m.errors.email)}}function R(l,n){if(l&1&&(o(0,"small"),s(1),r()),l&2){let e,t=p(2);i(),F((e=t.userForm.get("password"))==null||e.errors==null?null:e.errors.strongPassword.message)}}function z(l,n){if(l&1&&(o(0,"div",15),u(1,R,2,1,"small",16),r()),l&2){let e,t=p();i(),a("ngIf",(e=t.userForm.get("password"))==null||e.errors==null?null:e.errors.strongPassword)}}function H(l,n){if(l&1&&(o(0,"small"),s(1),r()),l&2){let e,t=p(2);i(),F((e=t.userForm.get("newPassword"))==null||e.errors==null?null:e.errors.strongPassword.message)}}function J(l,n){if(l&1&&(o(0,"div",15),u(1,H,2,1,"small",16),r()),l&2){let e,t=p();i(),a("ngIf",(e=t.userForm.get("newPassword"))==null||e.errors==null?null:e.errors.strongPassword)}}var G=class l{userService=g(b);fb=g(q);snackbar=g(S);userForm;loading=!0;user=null;ngOnInit(){this.userForm=this.fb.group({fullName:["",[c.required,c.minLength(10)]],email:["",[c.required,c.email,c.maxLength(30)]],password:["",[x()]],newPassword:["",[x()]]}),this.userService.getAuthState().subscribe(n=>{n&&(this.user=n,this.populateForm(n)),this.loading=!1})}populateForm(n){this.userForm.patchValue({fullName:n.fullName||"",email:n.email})}onSubmit(){if(this.userForm.invalid)return;let n=this.userForm.value,e={fullName:n.fullName,email:n.email};n.newPassword&&(e.password=n.newPassword),this.userService.updateProfile(e).subscribe({next:t=>{this.snackbar.success("User updated successfully!"),this.user&&this.userService.setAuthState(w(w({},this.user),t)),this.userForm.patchValue({password:"",newPassword:""})},error:t=>{console.error("Failed to update profile",t),this.snackbar.error("Error updating profile. Please try again.")}})}get f(){return this.userForm.controls}static \u0275fac=function(e){return new(e||l)};static \u0275cmp=P({type:l,selectors:[["app-account-personal-info"]],decls:29,vars:6,consts:[[3,"ngSubmit","formGroup"],[1,"row"],[1,"col-12"],[1,"form-group"],["for","accountFirstName",1,"form-label"],["id","fullName","formControlName","fullName","type","text","placeholder","Full Name *",1,"form-control","form-control-sm"],["class","text-danger",4,"ngIf"],["for","accountEmail",1,"form-label"],["id","email","formControlName","email","type","email","placeholder","Email Address *",1,"form-control","form-control-sm"],[1,"col-12","col-md-6"],["for","password",1,"form-label"],["id","password","formControlName","password","type","password","placeholder","Current Password",1,"form-control","form-control-sm"],["for","newPassword",1,"form-label"],["id","newPassword","formControlName","newPassword","type","password","placeholder","New Password",1,"form-control","form-control-sm"],["type","submit",1,"btn","btn-dark",3,"disabled"],[1,"text-danger"],[4,"ngIf"]],template:function(e,t){if(e&1&&(o(0,"form",0),h("ngSubmit",function(){return t.onSubmit()}),o(1,"div",1)(2,"div",2)(3,"div",3)(4,"label",4),s(5," Full Name * "),r(),f(6,"input",5),u(7,M,3,2,"div",6),r()(),o(8,"div",2)(9,"div",3)(10,"label",7),s(11," Email Address * "),r(),f(12,"input",8),u(13,B,4,3,"div",6),r()(),o(14,"div",9)(15,"div",3)(16,"label",10),s(17," Current Password "),r(),f(18,"input",11),u(19,z,2,1,"div",6),r()(),o(20,"div",9)(21,"div",3)(22,"label",12),s(23," New Password "),r(),f(24,"input",13),u(25,J,2,1,"div",6),r()(),o(26,"div",2)(27,"button",14),s(28," Save Changes "),r()()()()),e&2){let m,d,_,v;a("formGroup",t.userForm),i(7),a("ngIf",((m=t.userForm.get("fullName"))==null?null:m.invalid)&&((m=t.userForm.get("fullName"))==null?null:m.touched)),i(6),a("ngIf",((d=t.userForm.get("email"))==null?null:d.invalid)&&((d=t.userForm.get("email"))==null?null:d.touched)),i(6),a("ngIf",((_=t.userForm.get("password"))==null?null:_.invalid)&&((_=t.userForm.get("password"))==null?null:_.touched)),i(6),a("ngIf",((v=t.userForm.get("newPassword"))==null?null:v.invalid)&&((v=t.userForm.get("newPassword"))==null?null:v.touched)),i(2),a("disabled",t.userForm.invalid)}},dependencies:[I,C,D,A,N,E,y,T,U],encapsulation:2})};export{G as AccountPersonalInfoComponent};
